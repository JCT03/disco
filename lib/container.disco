using NoStdLib

import list
import product

-- eachset : (a -> b) * Set(a) -> Set(a)
-- eachset(f, s) = set(list(s))

reducebag : (a × a → a) × a × Bag(a) → a
reducebag(f,z,b) = foldr(f,z,each(fst,list(bagCounts(b))))

reduceset : (a × a → a) × a × Set(a) → a
reduceset(f,z,s) = foldr(f,z,list(s))

unions : Set(Set(a)) → Set(a)
unions(ss) = foldr(~∪~, {}, list(ss))